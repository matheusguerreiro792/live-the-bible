

=== ./src/stores/devotionals.ts ===

import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import { getLatestDevotional, getDevotionals } from '@/firebase/services/devotionals'

interface Devotional {
  id?: string
  title: string
  verse: {
    verse: string
    versions: {
      arc: string
      nvi: string
      ntlh: string
    }
  }
  theme: string
  introduction: string[]
  analysis: {
    title?: string
    text: string[]
  }[]
  practicalApplication: {
    title?: string
    text: string[]
  }[]
  reflection: string[]
  prayer: string[]
  createdAt: string
}

export const useDevotionalsStore = defineStore('devotionals', () => {
  const latestDevotional = ref<Devotional | null>(null)
  const allDevotionals = ref<Devotional[]>([])
  const selectedTheme = ref<string | null>(null)

  const isLoading = ref(false)
  const error = ref<string | null>(null)

  const LATEST_DEVOTIONAL_CACHE_KEY = 'latestDevotionalCache'
  const LATEST_DEVOTIONAL_LAST_FETCH_DATE_KEY = 'latestDevotionalLastFetchDate'
  const ALL_DEVOTIONALS_CACHE_KEY = 'allDevotionalsCache'
  const ALL_DEVOTIONALS_LAST_FETCH_DATE_KEY = 'allDevotionalsLastFetchDate'

  const isToday = (dateString: string): boolean => {
    const today = new Date()
    const cachedDate = new Date(dateString)
    return (
      today.getDate() === cachedDate.getDate() &&
      today.getMonth() === cachedDate.getMonth() &&
      today.getFullYear() === cachedDate.getFullYear()
    )
  }

  const fetchLatestDevotional = async () => {
    isLoading.value = true
    error.value = null

    try {
      const cachedData = localStorage.getItem(LATEST_DEVOTIONAL_CACHE_KEY)
      const lastFetchDate = localStorage.getItem(LATEST_DEVOTIONAL_LAST_FETCH_DATE_KEY)

      if (cachedData && lastFetchDate && isToday(lastFetchDate)) {
        latestDevotional.value = JSON.parse(cachedData) as Devotional
        console.log('Devocional mais recente carregado do cache local.')
        return
      }

      console.log('Buscando devocional mais recente do Firestore...')
      const devotional = await getLatestDevotional()

      if (devotional) {
        latestDevotional.value = devotional

        localStorage.setItem(LATEST_DEVOTIONAL_CACHE_KEY, JSON.stringify(devotional))
        localStorage.setItem(LATEST_DEVOTIONAL_LAST_FETCH_DATE_KEY, new Date().toISOString())
        console.log('Devocional mais recente salvo no cache local.')
      } else {
        latestDevotional.value = null
        error.value = 'Nenhum devocional encontrado. Por favor, adicione um na área administrativa.'
      }
    } catch (e: unknown) {
      const errorMessage = e instanceof Error ? e.message : 'Erro desconhecido'
      console.error('Erro ao buscar ou carregar devocional mais recente:', e)
      error.value = `Erro ao carregar devocional: ${errorMessage || 'Verifique sua conexão e as regras do Firebase.'}`

      localStorage.removeItem(LATEST_DEVOTIONAL_CACHE_KEY)
      localStorage.removeItem(LATEST_DEVOTIONAL_LAST_FETCH_DATE_KEY)
    } finally {
      isLoading.value = false
    }
  }

  const fetchAllDevotionals = async () => {
    isLoading.value = true
    error.value = null

    try {
      const cachedData = localStorage.getItem(ALL_DEVOTIONALS_CACHE_KEY)
      const lastFetchDate = localStorage.getItem(ALL_DEVOTIONALS_LAST_FETCH_DATE_KEY)

      if (cachedData && lastFetchDate && isToday(lastFetchDate)) {
        allDevotionals.value = JSON.parse(cachedData) as Devotional[]
        console.log('Lista de devocionais carregada do cache local.')
        return
      }

      console.log('Buscando lista de devocionais do Firestore...')
      const devotionals = await getDevotionals()

      if (devotionals && devotionals.length > 0) {
        allDevotionals.value = devotionals as Devotional[]
        localStorage.setItem(ALL_DEVOTIONALS_CACHE_KEY, JSON.stringify(devotionals))
        localStorage.setItem(ALL_DEVOTIONALS_LAST_FETCH_DATE_KEY, new Date().toISOString())
        console.log('Lista de devocionais salva no cache local.')
      } else {
        allDevotionals.value = []
        error.value = 'Nenhum devocional encontrado na lista.'
      }
    } catch (e: unknown) {
      const errorMessage = e instanceof Error ? e.message : 'Erro desconhecido'
      console.error('Erro ao buscar ou carregar lista de devocionais:', e)
      error.value = `Erro ao carregar lista de devocionais: ${errorMessage || 'Verifique sua conexão e as regras do Firebase.'}`
      localStorage.removeItem(ALL_DEVOTIONALS_CACHE_KEY)
      localStorage.removeItem(ALL_DEVOTIONALS_LAST_FETCH_DATE_KEY)
    } finally {
      isLoading.value = false
    }
  }

  const setSelectedTheme = (theme: string | null) => {
    selectedTheme.value = theme
  }

  const filteredDevotionals = computed(() => {
    if (!selectedTheme.value) {
      return allDevotionals.value
    }
    return allDevotionals.value.filter((devotional) => devotional.theme === selectedTheme.value)
  })

  const clearCache = () => {
    localStorage.removeItem(LATEST_DEVOTIONAL_CACHE_KEY)
    localStorage.removeItem(LATEST_DEVOTIONAL_LAST_FETCH_DATE_KEY)
    latestDevotional.value = null

    localStorage.removeItem(ALL_DEVOTIONALS_CACHE_KEY)
    localStorage.removeItem(ALL_DEVOTIONALS_LAST_FETCH_DATE_KEY)
    allDevotionals.value = []
    selectedTheme.value = null

    console.log('Cache de devocionais limpo.')
  }

  return {
    latestDevotional,
    allDevotionals,
    isLoading,
    error,
    fetchLatestDevotional,
    fetchAllDevotionals,
    selectedTheme,
    setSelectedTheme,
    filteredDevotionals,
    clearCache,
  }
})


=== ./src/firebase/services/devotionals.js ===

import { db } from '../config'
import {
  collection,
  getDocs,
  query,
  orderBy,
  limit,
  doc,
  getDoc,
  addDoc,
  updateDoc,
  deleteDoc,
} from 'firebase/firestore'

export const getDevotionals = async () => {
  try {
    const devotionalsRef = collection(db, 'devotionals')

    const q = query(devotionalsRef, orderBy('createdAt', 'desc'))
    const querySnapshot = await getDocs(q)
    const devotionals = []
    querySnapshot.forEach((doc) => {
      devotionals.push({ id: doc.id, ...doc.data() })
    })
    return devotionals
  } catch (error) {
    console.error('Erro ao buscar devocionais:', error)
    throw error
  }
}

export const getDevotional = async (id) => {
  try {
    const docRef = doc(db, 'devotionals', id)
    const docSnapshot = await getDoc(docRef)
    if (docSnapshot.exists()) {
      return { id: docSnapshot.id, ...docSnapshot.data() }
    } else {
      return null
    }
  } catch (error) {
    console.error('Erro ao buscar devocional:', error)
    throw error
  }
}

export const getLatestDevotional = async () => {
  try {
    const devotionalsRef = collection(db, 'devotionals')

    const q = query(devotionalsRef, orderBy('createdAt', 'desc'), limit(1))
    const querySnapshot = await getDocs(q)

    if (!querySnapshot.empty) {
      const doc = querySnapshot.docs[0]
      return { id: doc.id, ...doc.data() }
    } else {
      return null
    }
  } catch (error) {
    console.error('Erro ao buscar o devocional mais recente:', error)
    throw error
  }
}

export const postDevotional = async (devotional) => {
  try {
    const devotionalsRef = collection(db, 'devotionals')
    const docRef = await addDoc(devotionalsRef, devotional)
    return { id: docRef.id, ...devotional }
  } catch (error) {
    console.error('Erro ao adicionar devocional:', error)
    throw error
  }
}

export const updateDevotional = async (id, updatedData) => {
  try {
    const docRef = doc(db, 'devotionals', id)
    await updateDoc(docRef, updatedData)
    return { id, ...updatedData }
  } catch (error) {
    console.error('Erro ao atualizar devocional:', error)
    throw error
  }
}

export const deleteDevotional = async (id) => {
  try {
    const docRef = doc(db, 'devotionals', id)
    await deleteDoc(docRef)
  } catch (error) {
    console.error('Erro ao deletar devocional:', error)
    throw error
  }
}


=== ./src/firebase/services/devotionals.d.ts ===

declare module '@/firebase/services/devotionals' {
  export function getLatestDevotional(): Promise<Devotional | null>
  export function getDevotionals(): Promise<Devotional[]>
}


=== ./src/views/AdminView.vue ===

<script setup lang="ts">
import { ref } from 'vue'
import DevotionalForm from '@/components/DevotionalForm.vue'
import StudiesForm from '@/components/StudiesForm.vue'

const showDevotionalForm = ref(false)
const showStudyForm = ref(false)

const openDevotionalForm = () => {
  showDevotionalForm.value = true
}
const closeDevotionalForm = () => {
  showDevotionalForm.value = false
}

const openStudyForm = () => {
  showStudyForm.value = true
}
const closeStudyForm = () => {
  showStudyForm.value = false
}
</script>

<template>
  <main class="flex flex-col flex-1 bg-neutral-900 text-neutral-50 px-21 gap-4 p-4 items-center">
    <h1 class="text-3xl font-semibold text-yellow-500 w-full">Admin</h1>
    <div class="bg-neutral-800 flex flex-col gap-4 p-4 w-full rounded-lg shadow-md">
      <div class="flex justify-between items-center p-4 border-2 rounded-lg border-neutral-900">
        <h2 class="text-xl font-medium ml-3">Devotionals</h2>
        <button
          class="bg-green-600 py-2 px-3 rounded-lg cursor-pointer appearance-none hover:bg-green-700 active:bg-green-800"
          @click="openDevotionalForm"
        >
          Create
        </button>
      </div>
      <div class="flex justify-between items-center p-4 border-2 rounded-lg border-neutral-900">
        <h2 class="text-xl font-medium ml-3">Studies</h2>
        <button
          class="bg-green-600 py-2 px-3 rounded-lg cursor-pointer appearance-none hover:bg-green-700 active:bg-green-800"
          @click="openStudyForm"
        >
          Create
        </button>
      </div>
    </div>
    <DevotionalForm v-if="showDevotionalForm" @close="closeDevotionalForm" />
    <StudiesForm v-if="showStudyForm" @close="closeStudyForm" />
  </main>
</template>

<style scoped></style>


=== ./src/views/DevotionalsView.vue ===

<script setup lang="ts">
import { onMounted, computed, ref } from 'vue'
import { useDevotionalsStore } from '@/stores/devotionals'
import DevotionalsDevotional from '@/components/DevotionalsDevotional.vue'

type Devotional = (typeof devotionalStore.allDevotionals)[0]

const colors = [
  'bg-red-700 hover:bg-red-800 active:bg-red-600',
  'bg-orange-700 hover:bg-orange-800 active:bg-orange-600',
  'bg-amber-700 hover:bg-amber-800 active:bg-amber-600',
  'bg-yellow-700 hover:bg-yellow-800 active:bg-yellow-600',
  'bg-lime-700 hover:bg-lime-800 active:bg-lime-600',
  'bg-green-700 hover:bg-green-800 active:bg-green-600',
  'bg-emerald-700 hover:bg-emerald-800 active:bg-emerald-600',
  'bg-teal-700 hover:bg-teal-800 active:bg-teal-600',
  'bg-cyan-700 hover:bg-cyan-800 active:bg-cyan-600',
  'bg-sky-700 hover:bg-sky-800 active:bg-sky-600',
  'bg-blue-700 hover:bg-blue-800 active:bg-blue-600',
  'bg-indigo-700 hover:bg-indigo-800 active:bg-indigo-600',
  'bg-violet-700 hover:bg-violet-800 active:bg-violet-600',
  'bg-purple-700 hover:bg-purple-800 active:bg-purple-600',
  'bg-fuchsia-700 hover:bg-fuchsia-800 active:bg-fuchsia-600',
  'bg-pink-700 hover:bg-pink-800 active:bg-pink-600',
  'bg-rose-700 hover:bg-rose-800 active:bg-rose-600',
  'bg-slate-700 hover:bg-slate-800 active:bg-slate-600',
  'bg-gray-700 hover:bg-gray-800 active:bg-gray-600',
  'bg-zinc-700 hover:bg-zinc-800 active:bg-zinc-600',
  'bg-neutral-700 hover:bg-neutral-800 active:bg-neutral-600',
  'bg-stone-700 hover:bg-stone-800 active:bg-stone-600',
]

function getRandomColor() {
  return colors[Math.floor(Math.random() * colors.length)]
}

const devotionalStore = useDevotionalsStore()

const devotionalThemesWithColors = computed(() => {
  if (!devotionalStore.allDevotionals || devotionalStore.allDevotionals.length === 0) {
    return []
  }

  const themes = Array.from(
    new Set(devotionalStore.allDevotionals.map((devotional) => devotional.theme)),
  )

  const allThemes = [
    { theme: 'Todos os Temas', color: 'bg-fuchsia-900 hover:bg-fuchsia-950 active:bg-fuchsia-800' },
    ...themes.map((theme) => ({
      theme,
      color: getRandomColor(),
    })),
  ]

  return allThemes
})

const selectedDevotional = ref<Devotional | null>(null)

const handleDevotionalClick = (devotional: Devotional) => {
  selectedDevotional.value = devotional
}

const closeSelectedDevotional = () => {
  selectedDevotional.value = null
}

const handleThemeFilter = (theme: string) => {
  if (theme === 'Todos os Temas') {
    devotionalStore.setSelectedTheme(null)
  } else {
    devotionalStore.setSelectedTheme(theme)
  }
}

onMounted(() => {
  devotionalStore.fetchAllDevotionals()
})
</script>

<template>
  <main class="flex flex-col flex-1 px-21 gap-4 py-8 relative bg-neutral-100">
    <div v-if="devotionalThemesWithColors.length > 0" class="flex gap-2 flex-wrap">
      <div v-for="item in devotionalThemesWithColors" :key="item.theme">
        <button
          @click="handleThemeFilter(item.theme)"
          :class="[
            'flex py-1 px-2 rounded-lg font-medium cursor-pointer text-neutral-50 w-fit shadow text-sm',
            item.color,
            {
              'ring-2 ring-offset-2 ring-fuchsia-900':
                devotionalStore.selectedTheme === item.theme ||
                (item.theme === 'Todos os Temas' && !devotionalStore.selectedTheme),
            },
          ]"
        >
          {{ item.theme }}
        </button>
      </div>
    </div>

    <div v-if="devotionalStore.isLoading" class="text-fuchsia-900 text-lg font-semibold">
      Carregando devocionais...
    </div>
    <div
      v-else-if="devotionalStore.error"
      class="text-red-600 py-1 px-2 bg-red-50 border border-red-600 rounded-md"
    >
      {{ devotionalStore.error }}
    </div>
    <div
      v-else-if="devotionalStore.filteredDevotionals.length > 0"
      class="flex flex-wrap gap-4 mt-4"
    >
      <div
        v-for="devotional in devotionalStore.filteredDevotionals"
        :key="devotional.id"
        class="p-4 w-fit border border-fuchsia-950 rounded-lg shadow bg-white flex flex-col gap-2 cursor-pointer hover:bg-fuchsia-100 active:bg-fuchsia-50 relative overflow-hidden"
        @click="handleDevotionalClick(devotional)"
      >
        <h2 class="text-xl -mt-1.5 font-semibold text-fuchsia-950">{{ devotional.title }}</h2>
        <strong
          class="bg-fuchsia-50 border border-fuchsia-900 w-fit text-fuchsia-950 rounded-md px-2 py-0.5 flex items-center"
          >{{ devotional.verse.verse }}</strong
        >
        <div class="absolute bottom-0 right-0 bg-fuchsia-900 flex py-0.5 px-1 rounded-tl-md">
          <span
            class="shadow-lg text-xs font-medium bg-linear-to-tr from-zinc-300 via-zinc-100 to-zinc-300 bg-clip-text text-transparent drop-shadow-sm"
            >{{ devotional.theme }}</span
          >
        </div>
      </div>
    </div>
    <div v-else class="text-gray-600 text-lg">
      Nenhum devocional disponível para o tema selecionado.
    </div>

    <DevotionalsDevotional
      v-if="selectedDevotional"
      :devotional="selectedDevotional"
      @close="closeSelectedDevotional"
    />
  </main>
</template>


=== ./src/components/DevotionalForm.vue ===

<script setup lang="ts">
import { ref } from 'vue'
// Removido 'db', 'collection', 'addDoc' daqui
import { serverTimestamp } from 'firebase/firestore' // serverTimestamp ainda é usado
import IconXmark from './icons/IconXmark.vue'
import { postDevotional } from '@/firebase/services/devotionals' // Importa o serviço
import { useDevotionalsStore } from '@/stores/devotionals' // Importa o store para limpar o cache

const devotionalStore = useDevotionalsStore() // Instancia o store

const newDevotional = ref({
  title: '',
  verse: {
    verse: '',
    versions: {
      arc: '',
      nvi: '',
      ntlh: '',
    },
  },
  theme: '',
  introduction: [''],
  analysis: [{ title: '', text: [''] }],
  practicalApplication: [{ title: '', text: [''] }],
  reflection: [''],
  prayer: [''],
  createdAt: null,
})

// Funções auxiliares para adicionar/remover itens de arrays (mantidas)
const addParagraph = (array: string[]) => {
  array.push('')
}

const removeParagraph = (array: string[], index: number) => {
  if (array.length > 1) {
    array.splice(index, 1)
  }
}

const addAnalysisItem = () => {
  newDevotional.value.analysis.push({ title: '', text: [''] })
}

const removeAnalysisItem = (index: number) => {
  if (newDevotional.value.analysis.length > 1) {
    newDevotional.value.analysis.splice(index, 1)
  }
}

const addAnalysisParagraph = (item: { title?: string; text: string[] }) => {
  item.text.push('')
}

const removeAnalysisParagraph = (item: { title?: string; text: string[] }, index: number) => {
  if (item.text.length > 1) {
    item.text.splice(index, 1)
  }
}

const addPracticalApplicationItem = () => {
  newDevotional.value.practicalApplication.push({ title: '', text: [''] })
}

const removePracticalApplicationItem = (index: number) => {
  if (newDevotional.value.practicalApplication.length > 1) {
    newDevotional.value.practicalApplication.splice(index, 1)
  }
}

const addPracticalApplicationParagraph = (item: { title?: string; text: string[] }) => {
  item.text.push('')
}

const removePracticalApplicationParagraph = (
  item: { title?: string; text: string[] },
  index: number,
) => {
  if (item.text.length > 1) {
    item.text.splice(index, 1)
  }
}

// Função para lidar com o envio do formulário
const handleSubmit = async () => {
  try {
    newDevotional.value.createdAt = serverTimestamp()

    const savedDevotional = await postDevotional(newDevotional.value)
    console.log('Devocional salvo com ID: ', savedDevotional.id)
    alert('Devocional salvo com sucesso!')

    devotionalStore.clearCache()
    // devotionalStore.fetchLatestDevotional(); // Pode ser útil se você quiser que a HomeView atualize imediatamente

    newDevotional.value = {
      title: '',
      verse: {
        verse: '',
        versions: {
          arc: '',
          nvi: '',
          ntlh: '',
        },
      },
      theme: '',
      introduction: [''],
      analysis: [{ title: '', text: [''] }],
      practicalApplication: [{ title: '', text: [''] }],
      reflection: [''],
      prayer: [''],
      createdAt: null,
    }
  } catch (e) {
    console.error('Erro ao adicionar devocional: ', e)
    alert('Erro ao salvar devocional. Verifique o console para mais detalhes.')
  }
}
</script>

<template>
  <div
    class="relative bg-neutral-800 p-4 rounded-lg shadow-md flex flex-col gap-4 w-3/4 items-center"
  >
    <h2 class="font-semibold text-3xl text-fuchsia-400">New Devotional</h2>
    <button
      @click="$emit('close')"
      class="absolute top-4 right-4 bg-red-600 hover:bg-red-700 text-neutral-50 text-xs font-medium p-1 rounded"
    >
      <IconXmark color="var(--color-neutral-50)" />
    </button>

    <form @submit.prevent="handleSubmit" class="flex flex-col gap-6 w-full">
      <!-- Título do Devocional -->
      <div class="flex flex-col gap-2">
        <label for="title" class="text-fuchsia-400 text-sm font-medium">Title</label>
        <input
          type="text"
          id="title"
          v-model="newDevotional.title"
          class="text-neutral-50 bg-neutral-900 rounded-md py-2 px-3"
          required
        />
      </div>

      <!-- Versículo Base -->
      <div class="border-t border-fuchsia-400 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Verse</h3>
        <div class="flex flex-col gap-4">
          <div class="flex flex-col gap-2">
            <label for="verse" class="text-sm font-medium text-fuchsia-400">Verse Reference</label>
            <input
              type="text"
              id="verse"
              v-model="newDevotional.verse.verse"
              class="rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
              placeholder="Ex: 2 Coríntios 5:17"
              required
            />
          </div>
          <div class="flex flex-col gap-2">
            <label for="arc" class="font-medium text-fuchsia-400 text-sm">ARC version</label>
            <textarea
              id="arc"
              v-model="newDevotional.verse.versions.arc"
              rows="3"
              class="rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
              required
            ></textarea>
          </div>
          <div class="flex flex-col gap-2">
            <label for="nvi" class="font-medium text-fuchsia-400 text-sm">NVI version</label>
            <textarea
              id="nvi"
              v-model="newDevotional.verse.versions.nvi"
              rows="3"
              class="rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
              required
            ></textarea>
          </div>
          <div class="flex flex-col gap-2">
            <label for="ntlh" class="font-medium text-fuchsia-400 text-sm">NTLH version</label>
            <textarea
              id="ntlh"
              v-model="newDevotional.verse.versions.ntlh"
              rows="3"
              class="rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
              required
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Tema do Devocional -->
      <div class="flex flex-col gap-2">
        <label for="theme" class="text-fuchsia-400 text-sm font-medium">Theme</label>
        <input
          type="text"
          id="theme"
          v-model="newDevotional.theme"
          class="text-neutral-50 bg-neutral-900 rounded-md py-2 px-3"
          required
        />
      </div>

      <!-- Introdução -->
      <div class="border-t border-fuchsia-500 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Introduction</h3>
        <div
          v-for="(paragraph, index) in newDevotional.introduction"
          :key="index"
          class="flex items-center gap-2"
        >
          <textarea
            v-model="newDevotional.introduction[index]"
            rows="4"
            class="w-full rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
            :placeholder="`Parágrafo ${index + 1} da Introdução`"
            required
          ></textarea>
          <button
            type="button"
            @click="removeParagraph(newDevotional.introduction, index)"
            class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
            v-if="newDevotional.introduction.length > 1"
          >
            Delete
          </button>
        </div>
        <button
          type="button"
          @click="addParagraph(newDevotional.introduction)"
          class="inline-flex w-fit items-center px-3 py-2 border border-transparent font-medium rounded-md text-neutral-50 bg-fuchsia-700 hover:bg-fuchsia-800 focus:outline-none"
        >
          Add Paragraph
        </button>
      </div>

      <!-- Análise Profunda -->
      <div class="border-t border-fuchsia-400 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Deep Analysis</h3>
        <div
          v-for="(analysisItem, itemIndex) in newDevotional.analysis"
          :key="itemIndex"
          class="py-2 px-3 rounded-md bg-neutral-900 flex flex-col gap-2"
        >
          <div class="flex justify-between items-center gap-2">
            <h4 class="font-medium text-fuchsia-400">Analysis Item {{ itemIndex + 1 }}</h4>
            <button
              type="button"
              @click="removeAnalysisItem(itemIndex)"
              class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
              v-if="newDevotional.analysis.length > 1"
            >
              Delete Item
            </button>
          </div>
          <div class="flex items-center gap-2">
            <label
              :for="`analysis-title-${itemIndex}`"
              class="font-medium text-nowrap text-fuchsia-400 text-sm"
              >Item Title (Optional):</label
            >
            <input
              type="text"
              :id="`analysis-title-${itemIndex}`"
              v-model="analysisItem.title"
              class="rounded-md py-2 px-3 bg-neutral-800 w-full text-neutral-50"
              :placeholder="`Título para o item de análise ${itemIndex + 1}`"
            />
          </div>
          <div
            v-for="(paragraph, paragraphIndex) in analysisItem.text"
            :key="paragraphIndex"
            class="flex items-center gap-2"
          >
            <textarea
              v-model="analysisItem.text[paragraphIndex]"
              rows="4"
              class="w-full rounded-md py-2 px-3 bg-neutral-800 text-neutral-50"
              :placeholder="`Parágrafo ${paragraphIndex + 1} do item de análise ${itemIndex + 1}`"
              required
            ></textarea>
            <button
              type="button"
              @click="removeAnalysisParagraph(analysisItem, paragraphIndex)"
              class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
              v-if="analysisItem.text.length > 1"
            >
              Delete
            </button>
          </div>
          <button
            type="button"
            @click="addAnalysisParagraph(analysisItem)"
            class="inline-flex items-center px-3 py-2 border border-transparent font-medium rounded-md text-neutral-50 bg-fuchsia-600 hover:bg-fuchsia-700 w-fit"
          >
            Add Paragraph to Analysis
          </button>
        </div>
        <button
          type="button"
          @click="addAnalysisItem"
          class="inline-flex items-center px-3 py-2 border border-transparent font-medium rounded-md text-neutral-50 bg-fuchsia-600 w-fit hover:bg-fuchsia-700"
        >
          Add New Analysis Item
        </button>
      </div>

      <!-- Aplicação Prática -->
      <div class="border-t border-fuchsia-400 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Aplicação Prática</h3>
        <div
          v-for="(practicalItem, itemIndex) in newDevotional.practicalApplication"
          :key="itemIndex"
          class="py-2 px-3 rounded-md bg-neutral-900 flex flex-col gap-2"
        >
          <div class="flex justify-between items-center">
            <h4 class="text-base font-medium text-fuchsia-400">
              Application Item {{ itemIndex + 1 }}
            </h4>
            <button
              type="button"
              @click="removePracticalApplicationItem(itemIndex)"
              class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
              v-if="newDevotional.practicalApplication.length > 1"
            >
              Delete
            </button>
          </div>
          <div class="flex items-center gap-2">
            <label
              :for="`practical-title-${itemIndex}`"
              class="font-medium text-sm text-nowrap text-fuchsia-400"
              >Item Title (Optional):</label
            >
            <input
              type="text"
              :id="`practical-title-${itemIndex}`"
              v-model="practicalItem.title"
              class="rounded-md w-full py-2 px-3 bg-neutral-800 text-neutral-50"
              :placeholder="`Título para o item de aplicação ${itemIndex + 1}`"
            />
          </div>
          <div
            v-for="(paragraph, paragraphIndex) in practicalItem.text"
            :key="paragraphIndex"
            class="flex items-center gap-2"
          >
            <textarea
              v-model="practicalItem.text[paragraphIndex]"
              rows="4"
              class="w-full rounded-md py-2 px-3 bg-neutral-800 text-neutral-50"
              :placeholder="`Parágrafo ${paragraphIndex + 1} do item de aplicação ${itemIndex + 1}`"
              required
            ></textarea>
            <button
              type="button"
              @click="removePracticalApplicationParagraph(practicalItem, paragraphIndex)"
              class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
              v-if="practicalItem.text.length > 1"
            >
              Delete
            </button>
          </div>
          <button
            type="button"
            @click="addPracticalApplicationParagraph(practicalItem)"
            class="inline-flex items-center px-3 py-2 border border-transparent w-fit font-medium rounded-md text-neutral-50 bg-fuchsia-600 hover:bg-fuchsia-700"
          >
            Add Paragraph to Application
          </button>
        </div>
        <button
          type="button"
          @click="addPracticalApplicationItem"
          class="inline-flex items-center px-3 py-2 border border-transparent w-fit font-medium rounded-md text-neutral-50 bg-fuchsia-600 hover:bg-fuchsia-700"
        >
          Add New Application Item
        </button>
      </div>

      <!-- Reflexão Pessoal -->
      <div class="border-t border-fuchsia-400 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Personal Reflection</h3>
        <div
          v-for="(paragraph, index) in newDevotional.reflection"
          :key="index"
          class="flex items-center gap-2"
        >
          <textarea
            v-model="newDevotional.reflection[index]"
            rows="4"
            class="w-full rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
            :placeholder="`Pergunta ou Parágrafo ${index + 1} da Reflexão`"
            required
          ></textarea>
          <button
            type="button"
            @click="removeParagraph(newDevotional.reflection, index)"
            class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
            v-if="newDevotional.reflection.length > 1"
          >
            Delete
          </button>
        </div>
        <button
          type="button"
          @click="addParagraph(newDevotional.reflection)"
          class="inline-flex items-center px-3 py-2 border w-fit border-transparent font-medium rounded-md text-neutral-50 bg-fuchsia-600 hover:bg-fuchsia-700"
        >
          Add Paragraph/Question
        </button>
      </div>

      <!-- Oração -->
      <div class="border-t border-fuchsia-400 pt-4 flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-fuchsia-400">Prayer</h3>
        <div
          v-for="(paragraph, index) in newDevotional.prayer"
          :key="index"
          class="flex items-center gap-2"
        >
          <textarea
            v-model="newDevotional.prayer[index]"
            rows="4"
            class="w-full rounded-md py-2 px-3 bg-neutral-900 text-neutral-50"
            :placeholder="`Parágrafo ${index + 1} da Oração`"
            required
          ></textarea>
          <button
            type="button"
            @click="removeParagraph(newDevotional.prayer, index)"
            class="bg-red-600 hover:bg-red-700 py-2 px-3 rounded-md text-neutral-50 text-sm font-medium"
            v-if="newDevotional.prayer.length > 1"
          >
            Delete
          </button>
        </div>
        <button
          type="button"
          @click="addParagraph(newDevotional.prayer)"
          class="inline-flex items-center w-fit px-3 py-2 font-medium rounded-md text-neutral-50 bg-fuchsia-600 hover:bg-fuchsia-700"
        >
          Add Paragraph
        </button>
      </div>

      <!-- Botão de Envio -->
      <div class="">
        <button
          type="submit"
          class="w-full inline-flex justify-center py-3 px-6 border border-transparent text-lg font-medium rounded-md text-neutral-50 bg-fuchsia-700 hover:bg-fuchsia-800"
        >
          Save Devotional
        </button>
      </div>
    </form>
  </div>
</template>


=== ./src/components/DevotionalsDevotional.vue ===

<script setup lang="ts">
import IconXmark from './icons/IconXmark.vue'

defineProps<{
  devotional: {
    title: string
    verse: {
      verse: string
      versions: {
        arc: string
        nvi: string
        ntlh: string
      }
    }
    theme: string
    introduction: string[]
    analysis: {
      title?: string
      text: string[]
    }[]
    practicalApplication: {
      title?: string
      text: string[]
    }[]
    reflection: string[]
    prayer: string[]
  } | null
}>()

const emit = defineEmits(['close'])

const closeDevotional = () => {
  emit('close')
}
</script>

<template>
  <div
    v-if="devotional"
    class="absolute top-0 left-0 w-full h-full bg-neutral-950/75 flex items-center justify-center"
  >
    <div class="bg-neutral-50 py-4 px-5 gap-4 flex flex-col w-3/4 h-full overflow-y-auto relative">
      <button
        @click="closeDevotional"
        class="absolute top-6 right-5 bg-red-700 hover:bg-red-800 text-neutral-50 rounded-full text-sm font-medium flex items-center justify-center w-6 h-6"
        aria-label="Fechar devocional"
      >
        <IconXmark color="currentColor" class="w-3.5 h-3.5" />
      </button>

      <div class="flex flex-col gap-4">
        <div class="absolute top-0 right-0 bg-fuchsia-900 flex py-0.5 px-1 rounded-bl-md">
          <span
            class="text-xs font-medium bg-linear-to-tr from-zinc-300 via-zinc-100 to-zinc-300 bg-clip-text text-transparent"
            >{{ devotional.theme }}</span
          >
        </div>
        <h2 class="font-semibold text-2xl text-fuchsia-950 w-fit">
          {{ devotional.title }}
        </h2>
        <strong
          class="bg-fuchsia-50 border border-fuchsia-900 w-fit text-fuchsia-950 rounded-md px-2 py-1 flex items-center"
          >{{ devotional.verse.verse }}</strong
        >
        <ul class="flex flex-col gap-2">
          <li class="flex items-center gap-4">
            <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
            <strong class="font-semibold text-xs w-8 text-fuchsia-900">ARC</strong>
            <span>{{ devotional.verse.versions.arc }}</span>
          </li>
          <li class="flex items-center gap-4">
            <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
            <strong class="font-semibold text-xs w-8 text-fuchsia-900">NVI</strong>
            <span>{{ devotional.verse.versions.nvi }}</span>
          </li>
          <li class="flex items-center gap-4">
            <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
            <strong class="font-semibold text-xs w-8 text-fuchsia-900">NTLH</strong>
            <span>{{ devotional.verse.versions.ntlh }}</span>
          </li>
        </ul>
        <hr class="text-fuchsia-900 -mb-0.5" />
        <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Introdução</h3>
        <p v-for="(p, i) in devotional.introduction" :key="i" class="text-justify">{{ p }}</p>
        <hr class="text-fuchsia-900 -mb-0.5" />
        <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Análise Profunda</h3>
        <p v-for="(p, i) in devotional.analysis[0]?.text" :key="i" class="text-justify">{{ p }}</p>
        <div v-for="(o, i) in devotional.analysis.slice(1)" :key="i" class="flex flex-col gap-2">
          <h4 class="text-fuchsia-900 font-semibold text-base">{{ o.title }}</h4>
          <p v-for="(p, j) in o.text" :key="j" class="text-justify">{{ p }}</p>
        </div>
        <hr class="text-fuchsia-900 -mb-0.5" />
        <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Aplicação Prática</h3>
        <p v-for="(p, i) in devotional.practicalApplication[0]?.text" :key="i" class="text-justify">
          {{ p }}
        </p>
        <ol class="flex flex-col gap-4">
          <li
            v-for="(o, i) in devotional.practicalApplication.slice(1)"
            :key="i"
            class="text-justify list-decimal list-inside flex flex-col gap-2"
          >
            <strong class="text-fuchsia-900 font-semibold">
              <span class="text-neutral-950 font-normal text-sm">{{ i + 1 }}.</span>
              {{ o.title }}</strong
            >
            <p v-for="(p, j) in o.text" :key="j" class="text-justify">
              {{ p }}
            </p>
          </li>
        </ol>
        <hr class="text-fuchsia-900 -mb-0.5" />
        <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Reflexão Pessoal</h3>
        <p class="text-justify">{{ devotional.reflection[0] }}</p>
        <ul class="flex flex-col gap-1">
          <li
            v-for="(p, i) in devotional.reflection.slice(1)"
            :key="i"
            class="text-justify list-disc list-inside"
          >
            {{ p }}
          </li>
        </ul>
        <hr class="text-fuchsia-900 -mb-0.5" />
        <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Oração</h3>
        <p v-for="(p, i) in devotional.prayer" :key="i" class="text-justify">{{ p }}</p>
      </div>
    </div>
  </div>
</template>


=== ./src/views/HomeView.vue ===

<script setup lang="ts">
import { onMounted } from 'vue'
import HomeDevotional from '@/components/HomeDevotional.vue'
import { useDevotionalsStore } from '@/stores/devotionals'

const devotionalStore = useDevotionalsStore()

onMounted(() => {
  devotionalStore.fetchLatestDevotional()
})
</script>

<template>
  <main className="flex flex-col bg-neutral-200 flex-1 items-center gap-4 py-8 px-21">
    <h2
      class="text-2xl font-medium p-1 text-neutral-50 rounded-lg bg-[linear-gradient(to_right,var(--color-fuchsia-900),var(--color-fuchsia-800),var(--color-fuchsia-800),var(--color-fuchsia-900))] flex justify-center w-full shadow"
    >
      Devocional
    </h2>
    <div v-if="devotionalStore.isLoading" class="text-fuchsia-900 text-lg font-semibold">
      Carregando devocional...
    </div>
    <div
      v-else-if="devotionalStore.error"
      class="text-red-700 py-1 px-2 bg-red-50 border border-red-600 rounded-md"
    >
      {{ devotionalStore.error }}
    </div>
    <HomeDevotional
      v-else-if="devotionalStore.latestDevotional"
      :devotional="devotionalStore.latestDevotional"
    />
    <div v-else class="text-neutral-950 text-lg">Nenhum devocional disponível no momento.</div>
    <h2
      class="text-2xl font-medium p-1 text-neutral-50 rounded-lg bg-[linear-gradient(to_right,var(--color-fuchsia-900),var(--color-fuchsia-800),var(--color-fuchsia-800),var(--color-fuchsia-900))] flex justify-center w-full shadow"
    >
      Estudo
    </h2>
  </main>
</template>


=== ./src/components/HomeDevotional.vue ===

<script setup lang="ts">
defineProps<{
  devotional: {
    title: string
    verse: {
      verse: string
      versions: {
        arc: string
        nvi: string
        ntlh: string
      }
    }
    theme: string
    introduction: string[]
    analysis: {
      title?: string
      text: string[]
    }[]
    practicalApplication: {
      title?: string
      text: string[]
    }[]
    reflection: string[]
    prayer: string[]
  }
}>()
</script>

<template>
  <div
    class="relative bg-neutral-50 py-4 px-5 gap-4 rounded-lg shadow-md overflow-hidden flex flex-col"
  >
    <div class="absolute top-0 right-0 bg-fuchsia-900 flex py-0.5 px-1 rounded-bl-md">
      <span
        class="shadow-lg text-xs font-medium bg-gradient-to-tr from-zinc-300 via-zinc-100 to-zinc-300 bg-clip-text text-transparent drop-shadow-sm"
        >{{ devotional.theme }}</span
      >
    </div>
    <h2 class="font-semibold text-2xl py-0 text-fuchsia-950 px-1 rounded-md w-fit">
      {{ devotional.title }}
    </h2>
    <strong
      class="bg-fuchsia-50 border border-fuchsia-900 w-fit text-fuchsia-950 rounded-md px-2 py-0.5 flex items-center"
      >{{ devotional.verse.verse }}</strong
    >
    <ul class="flex flex-col gap-2">
      <li class="flex items-center gap-4">
        <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
        <strong class="font-semibold text-xs w-8 text-fuchsia-900">ARC</strong>
        <span>{{ devotional.verse.versions.arc }}</span>
      </li>
      <li class="flex items-center gap-4">
        <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
        <strong class="font-semibold text-xs w-8 text-fuchsia-900">NVI</strong>
        <span>{{ devotional.verse.versions.nvi }}</span>
      </li>
      <li class="flex items-center gap-4">
        <div class="bg-fuchsia-950 w-1.5 h-1.5 rounded-full"></div>
        <strong class="font-semibold text-xs w-8 text-fuchsia-900">NTLH</strong>
        <span>{{ devotional.verse.versions.ntlh }}</span>
      </li>
    </ul>
    <hr class="text-fuchsia-900 -mb-0.5" />
    <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Introdução</h3>
    <p v-for="(p, i) in devotional.introduction" :key="i" class="text-justify">{{ p }}</p>
    <hr class="text-fuchsia-900 -mb-0.5" />
    <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Análise Profunda</h3>
    <p v-for="(p, i) in devotional.analysis[0]?.text" :key="i" class="text-justify">{{ p }}</p>
    <div v-for="(o, i) in devotional.analysis.slice(1)" :key="i" class="flex flex-col gap-2">
      <h4 class="text-fuchsia-900 font-semibold text-base">{{ o.title }}</h4>
      <p v-for="(p, j) in o.text" :key="j" class="text-justify">{{ p }}</p>
    </div>
    <hr class="text-fuchsia-900 -mb-0.5" />
    <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Aplicação Prática</h3>
    <p v-for="(p, i) in devotional.practicalApplication[0]?.text" :key="i" class="text-justify">
      {{ p }}
    </p>
    <ol class="flex flex-col gap-4">
      <li
        v-for="(o, i) in devotional.practicalApplication.slice(1)"
        :key="i"
        class="text-justify list-decimal list-inside flex flex-col gap-2"
      >
        <strong class="text-fuchsia-900 font-semibold">
          <span class="text-neutral-950 font-normal text-sm">{{ i + 1 }}.</span>
          {{ o.title }}</strong
        >
        <p v-for="(p, j) in o.text" :key="j" class="text-justify">
          {{ p }}
        </p>
      </li>
    </ol>
    <hr class="text-fuchsia-900 -mb-0.5" />
    <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Reflexão Pessoal</h3>
    <p class="text-justify">{{ devotional.reflection[0] }}</p>
    <ul class="flex flex-col gap-1">
      <li
        v-for="(p, i) in devotional.reflection.slice(1)"
        :key="i"
        class="text-justify list-disc list-inside"
      >
        {{ p }}
      </li>
    </ul>
    <hr class="text-fuchsia-900 -mb-0.5" />
    <h3 class="text-fuchsia-950 font-semibold text-lg -mb-2">Oração</h3>
    <p v-for="(p, i) in devotional.prayer" :key="i" class="text-justify">{{ p }}</p>
  </div>
</template>


=== ./src/views/StudiesView.vue ===

<script setup lang="ts"></script>

<template>
  <main class="flex flex-col flex-1 px-21 py-7">Em desenvolvimento...</main>
</template>


=== ./src/components/StudiesForm.vue ===

<script setup lang="ts"></script>

<template>
  <div>formulário de estudos</div>
</template>


=== ./src/router/index.ts ===

import { createRouter, createWebHistory } from 'vue-router'
import { auth } from '@/firebase/config'
import { onAuthStateChanged } from 'firebase/auth'
import HomeView from '@/views/HomeView.vue'
import LoginView from '@/views/LoginView.vue'
import AdminView from '@/views/AdminView.vue'

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    {
      path: '/',
      name: 'home',
      component: HomeView,
    },
    {
      path: '/login',
      name: 'login',
      component: LoginView,
    },
    {
      path: '/admin',
      name: 'admin',
      component: () => import('../views/AdminView.vue'),
      meta: { requiresAuth: true },
    },
    {
      path: '/devocionais',
      name: 'devocionais',
      component: () => import('../views/DevotionalsView.vue'),
    },
    {
      path: '/estudos',
      name: 'estudos',
      component: () => import('../views/StudiesView.vue'),
    },
    {
      path: '/sobre',
      name: 'sobre',
      component: () => import('../views/AboutView.vue'),
    },
  ],
})

router.beforeEach(async (to, from, next) => {
  const requiresAuth = to.matched.some((record) => record.meta.requiresAuth)
  const currentUser = auth.currentUser

  if (requiresAuth && !currentUser) {
    console.log('Rota protegida, redirecionando para login.')
    next('/login')
  } else if (!requiresAuth && currentUser && to.path === '/login') {
    console.log('Usuário já logado, redirecionando para admin.')
    next('/admin')
  } else {
    next()
  }
})

export default router
